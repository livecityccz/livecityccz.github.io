<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>burpsuite插件开发之检测越权访问漏洞 | chucz&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="那个喝醉的夜晚，挡不住我们的步伐  　　前些天公司买了些BurpSuite的License，终于可以用上正版了，先给公司来波赞！好啦，言归正传，BurpSuite作为Web安全测试的一大神器，其中一个优势就是其扩展性好。BurpSuite支持Java、Python、Ruby作为其插件的扩展语言，而在其内置的Bapp_Store中也有很多很强大的插件。作为一名程序猿，心想是时候自己动手开发一款专属">
<meta name="keywords" content="编程之道,burpsuite">
<meta property="og:type" content="article">
<meta property="og:title" content="burpsuite插件开发之检测越权访问漏洞">
<meta property="og:url" content="http://chucz.club/2018/05/04/burpsuite插件开发之检测越权访问漏洞/index.html">
<meta property="og:site_name" content="chucz&#39;s blog">
<meta property="og:description" content="那个喝醉的夜晚，挡不住我们的步伐  　　前些天公司买了些BurpSuite的License，终于可以用上正版了，先给公司来波赞！好啦，言归正传，BurpSuite作为Web安全测试的一大神器，其中一个优势就是其扩展性好。BurpSuite支持Java、Python、Ruby作为其插件的扩展语言，而在其内置的Bapp_Store中也有很多很强大的插件。作为一名程序猿，心想是时候自己动手开发一款专属">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://chucz.club/upload_image/20180504/1.png">
<meta property="og:image" content="http://chucz.club/upload_image/20180504/2.png">
<meta property="og:image" content="http://chucz.club/upload_image/20180504/3.png">
<meta property="og:image" content="http://chucz.club/upload_image/20180504/4.png">
<meta property="og:image" content="http://chucz.club/upload_image/20180504/6.png">
<meta property="og:image" content="http://chucz.club/upload_image/20180504/5.png">
<meta property="og:updated_time" content="2018-09-28T08:51:24.508Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="burpsuite插件开发之检测越权访问漏洞">
<meta name="twitter:description" content="那个喝醉的夜晚，挡不住我们的步伐  　　前些天公司买了些BurpSuite的License，终于可以用上正版了，先给公司来波赞！好啦，言归正传，BurpSuite作为Web安全测试的一大神器，其中一个优势就是其扩展性好。BurpSuite支持Java、Python、Ruby作为其插件的扩展语言，而在其内置的Bapp_Store中也有很多很强大的插件。作为一名程序猿，心想是时候自己动手开发一款专属">
<meta name="twitter:image" content="http://chucz.club/upload_image/20180504/1.png">
  
    <link rel="alternate" href="/atom.xml" title="chucz&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">chucz&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://chucz.club"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-burpsuite插件开发之检测越权访问漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/04/burpsuite插件开发之检测越权访问漏洞/" class="article-date">
  <time datetime="2018-05-04T08:26:28.000Z" itemprop="datePublished">2018-05-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      burpsuite插件开发之检测越权访问漏洞
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>那个喝醉的夜晚，挡不住我们的步伐</p>
</blockquote>
<p>　　前些天公司买了些BurpSuite的License，终于可以用上正版了，先给公司来波赞！好啦，言归正传，BurpSuite作为Web安全测试的一大神器，其中一个优势就是其扩展性好。BurpSuite支持Java、Python、Ruby作为其插件的扩展语言，而在其内置的Bapp_Store中也有很多很强大的插件。作为一名程序猿，心想是时候自己动手开发一款专属插件了，抱着此心态我便开始尝试学习摸索着Coding，于是便有了此文。<br><a id="more"></a></p>
<h3 id="插件语言的选择"><a href="#插件语言的选择" class="headerlink" title="插件语言的选择"></a><a href="#插件语言的选择" title="插件语言的选择"></a>插件语言的选择</h3><p>　　以上所述Burp支持Java、Python、Ruby语言的扩展，相对来说我更熟悉Python，因此就用Python开始学习写插件，对于速度要求高的朋友可以用Java写。熟悉Python的朋友肯定知道，Python分为Cython、Jython等。前者就是我们通常所说的Python，后者是Java版本的Python，简单理解就是用Jython可以调用Java的库。</p>
<h3 id="burpsuite-jython开发环境"><a href="#burpsuite-jython开发环境" class="headerlink" title="burpsuite jython开发环境"></a><a href="#burpsuite-jython开发环境" title="burpsuite jython开发环境"></a>burpsuite jython开发环境</h3><p>　　想要开发使用一款属于自己的BurpSuite插件，必须要部署好Jython开发环境以及Jython运行环境。前者需要在开发jython程序的平台上搭建环境，后者需要在运行burpsuite的平台搭建环境。鉴于一般开发以及使用插件都在用一个平台上，比如mac，因此本文介绍一下如何在mac上安装jython环境。</p>
<h4 id="install-jython-for-Mac"><a href="#install-jython-for-Mac" class="headerlink" title="install jython for Mac"></a><a href="#install-jython-for-Mac" title="install jython for Mac"></a>install jython for Mac</h4><p>首先我们需要在mac上安装jython的环境以便开发jython程序，就像安装python环境一样，mac上安装jython命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install jython</div></pre></td></tr></table></figure>

<p>安装完以后，jython安装在/usr/local/Cellar/jython/目录下，需要设置环境变量，将/usr/local/Cellar/jython/2.7.1/libexec/bin添加到环境变量，然后在shell中输入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$jython</span></div><div class="line">Jython 2.7.1 (default:0df7adb1b397, Jun 30 2017, 19:02:43)</div><div class="line">[Java HotSpot(TM) 64-Bit Server VM (Oracle Corporation)] on java1.8.0_111</div><div class="line">Type <span class="string">“help”</span>, <span class="string">“copyright”</span>, <span class="string">“credits”</span> or <span class="string">“license”</span> <span class="keyword">for</span> more information.</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>

<p>说明：其他平台（windows，linux）安装jython方式请自行google，应该比较类似。</p>
<h4 id="Load-Jython-to-Burpsuite"><a href="#Load-Jython-to-Burpsuite" class="headerlink" title="Load Jython to Burpsuite"></a><a href="#Load-Jython-to-Burpsuite" title="Load Jython to Burpsuite"></a>Load Jython to Burpsuite</h4><p>mac上安装完jython环境后，需要在burpsuite中加载jython环境，注意这里选择的是jar文件。<br><img src="/upload_image/20180504/1.png" alt=""></p>
<h3 id="开发jython程序"><a href="#开发jython程序" class="headerlink" title="开发jython程序"></a><a href="#开发jython程序" title="开发jython程序"></a>开发jython程序</h3><p>本篇以开发一款检测未授权访问漏洞的插件为例介绍一下插件的开发过程，由于本文重点在于介绍如何开发一款bp插件，以及一些不可抗因素，本文介绍的插件均为简化后的版本。</p>
<h4 id="创建main-py文件"><a href="#创建main-py文件" class="headerlink" title="创建main.py文件"></a><a href="#创建main-py文件" title="创建main.py文件"></a>创建main.py文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#! -<em>- coding:utf-8 -</em>-</span></div><div class="line"></div><div class="line">import re</div><div class="line">from burp import IBurpExtender <span class="comment"># 定义插件的基本信息类</span></div><div class="line">from burp import IHttpListener <span class="comment"># http流量监听类</span></div><div class="line">from noauth import noauth_request</div><div class="line"></div><div class="line"><span class="comment"># 敏感接口检测，并输出敏感接口信息</span></div><div class="line">res_host = re.compile(r<span class="string">‘Host: ([^,]<em>)’</em></span>)</div><div class="line">res_path = re.compile(r<span class="string">‘(GET|POST) ([^ ]) HTTP/‘</span>)</div><div class="line"></div><div class="line"></div><div class="line">class BurpExtender(IBurpExtender, IHttpListener):</div><div class="line">    def registerExtenderCallbacks(self, callbacks):</div><div class="line">        self._callbacks = callbacks</div><div class="line">        self._helpers = callbacks.getHelpers() <span class="comment"># 通用函数</span></div><div class="line">        self._callbacks.setExtensionName(<span class="string">“sensitive_interface_scan”</span>)</div><div class="line"></div><div class="line">        <span class="built_in">print</span> <span class="string">“load sensitive_interface_scan plugin success!”</span></div><div class="line">        <span class="built_in">print</span> <span class="string">“=============================================”</span></div><div class="line">        <span class="built_in">print</span> <span class="string">“”</span></div><div class="line"></div><div class="line">        <span class="comment"># register ourselves as an HTTP listener</span></div><div class="line">        callbacks.registerHttpListener(self)</div><div class="line">    </div><div class="line">    def processHttpMessage(self, toolFlag, messageIsRequest, messageInfo):</div><div class="line">        <span class="keyword">if</span> toolFlag == 4:</div><div class="line">            <span class="keyword">if</span> not messageIsRequest:</div><div class="line">                response = messageInfo.getResponse() <span class="comment"># get response</span></div><div class="line">                analyzedResponse = self._helpers.analyzeResponse(response)</div><div class="line">                body = response[analyzedResponse.getBodyOffset():] </div><div class="line">                body_string = body.tostring() <span class="comment"># get response_body</span></div><div class="line"></div><div class="line">                request = messageInfo.getRequest()</div><div class="line">                analyzedRequest = self._helpers.analyzeResponse(request)</div><div class="line">                request_header = analyzedRequest.getHeaders() </div><div class="line">                try:</div><div class="line">                    method,path = res_path.findall(request_header[0])[0]</div><div class="line">                    host = res_host.findall(request_header[1])[0]</div><div class="line">                    url = method+<span class="string">“ “</span>+host+path</div><div class="line">                except:</div><div class="line">                    url = <span class="string">“”</span></div><div class="line"></div><div class="line">                <span class="keyword">if</span> method==<span class="string">“GET”</span>:</div><div class="line">                    <span class="comment"># 检测GET请求的接口</span></div><div class="line"></div><div class="line">                    <span class="built_in">print</span> <span class="string">“[Info]Check url is “</span>,url</div><div class="line"></div><div class="line">                    cur = noauth_request(host,path,body_string)</div><div class="line">                    noauth_result = cur.run()</div><div class="line"></div><div class="line">                    <span class="keyword">if</span> noauth_result: </div><div class="line">                        <span class="built_in">print</span> <span class="string">“[Info]Found it is a noauth Interface %s”</span> % noauth_result[0][0]</div><div class="line">                        <span class="built_in">print</span> <span class="string">“[Info]remove param is “</span>,noauth_result[0][1]</div><div class="line"></div><div class="line">                    <span class="built_in">print</span> <span class="string">“======================================================================================”</span></div><div class="line">                    <span class="built_in">print</span> <span class="string">“”</span></div></pre></td></tr></table></figure>

<p>说明：此文件为插件入口文件，其中导入的burp内置类IBurpExtender为基类，即所有插件都需要使用继承此类，IHttpListener类用来获取http请求以及响应内容。</p>
<h4 id="创建noauth-py文件"><a href="#创建noauth-py文件" class="headerlink" title="创建noauth.py文件"></a><a href="#创建noauth-py文件" title="创建noauth.py文件"></a>创建noauth.py文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#! -<em>- coding:utf-8 -</em>-</span></div><div class="line"></div><div class="line"><span class="string">‘’</span><span class="string">‘未授权访问poc(GET)’</span><span class="string">‘’</span></div><div class="line"></div><div class="line">import requests</div><div class="line">from furl import furl</div><div class="line"></div><div class="line">auth_params=[<span class="string">“token”</span>,<span class="string">“sign”</span>,<span class="string">“ticket”</span>]</div><div class="line"></div><div class="line"><span class="comment"># headers 里面除去cookie</span></div><div class="line"></div><div class="line">headers=&#123;</div><div class="line">    </div><div class="line">    <span class="string">“User-Agent”</span>:<span class="string">“Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36”</span>,</div><div class="line">    <span class="string">“Accept-Language”</span>:<span class="string">“zh-CN,zh;q=0.9,en;q=0.8,mt;q=0.7,zh-TW;q=0.6”</span>,</div><div class="line">    <span class="string">“Accept-Encoding”</span>:<span class="string">“gzip, deflate”</span>,</div><div class="line">    <span class="string">“Accept”</span>:<span class="string">“text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,<em>/</em>;q=0.8”</span>,</div><div class="line">    <span class="string">“Cookie”</span>:<span class="string">“test”</span>,</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">class noauth_request(object):</div><div class="line">    <span class="comment"># 未授权访问漏洞检测</span></div><div class="line"></div><div class="line">    def <strong>init</strong>(self,host,path,body_string):</div><div class="line"></div><div class="line">        self.url = <span class="string">“http://“</span>+host+path</div><div class="line">        self.uri = str(furl(self.url).remove(args=True))</div><div class="line">        self.body_string = body_string</div><div class="line">        self.param = dict(furl(self.url).args)</div><div class="line">        self.remove_param = []</div><div class="line"></div><div class="line">    def run(self):</div><div class="line">        </div><div class="line">        result_list=[]</div><div class="line"></div><div class="line">        self.remove_auth() <span class="comment"># remove params,example:auth,token,sign……</span></div><div class="line"></div><div class="line">        response_body,current_url = self.get_response()</div><div class="line"></div><div class="line">        <span class="keyword">if</span> response_body == self.body_string:</div><div class="line"></div><div class="line">            result_list.append((current_url,self.remove_param,response_body))</div><div class="line">        </div><div class="line">        <span class="built_in">return</span> result_list</div><div class="line"></div><div class="line">    def remove_auth(self):</div><div class="line">        <span class="comment"># 删除用户认证的参数</span></div><div class="line"></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> auth_params:</div><div class="line">            <span class="keyword">if</span> self.param.has_key(i):</div><div class="line">                self.remove_param.append(i)</div><div class="line">                self.param.pop(i)</div><div class="line"></div><div class="line">    def get_response(self):</div><div class="line">        <span class="comment"># 重放接口获取返回值</span></div><div class="line"></div><div class="line">        current_url = <span class="string">“”</span></div><div class="line">        response_body = <span class="string">“”</span></div><div class="line"></div><div class="line">        try:</div><div class="line">            res=requests.get(url=self.uri, params=self.param, timeout=20, headers=headers)</div><div class="line">        except Exception,e:</div><div class="line">            <span class="built_in">print</span> <span class="string">“[noauth_request:get_response]”</span>+str(e)</div><div class="line"></div><div class="line">            <span class="keyword">if</span> <span class="string">“HTTPSConnectionPool”</span> <span class="keyword">in</span> str(e):</div><div class="line">                try:</div><div class="line">                    res=requests.get(url=self.uri.replace(<span class="string">“http://“</span>,<span class="string">“https://“</span>), params=self.param, timeout=20, headers=headers)</div><div class="line">                except Exception,e:</div><div class="line">                    <span class="built_in">print</span> <span class="string">“[noauth_request:get_response]”</span>+str(e)</div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    current_url = res.url</div><div class="line">                    response_body = res.text</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            current_url = res.url</div><div class="line">            response_body = res.text</div><div class="line"></div><div class="line">        <span class="built_in">return</span> response_body,current_url</div></pre></td></tr></table></figure>

<p>说明：此文件为检测未授权访问类，功能比较简单，获取原始请求以及响应包，去除请求接口的cookie以及token等认证后重放，查看返回结果有没有变化。一般情况下还会检测响应包是否包含敏感信息，这里为了方便演示，简化了插件功能。</p>
<h3 id="将jython程序添加到burpsuite中"><a href="#将jython程序添加到burpsuite中" class="headerlink" title="将jython程序添加到burpsuite中"></a><a href="#将jython程序添加到burpsuite中" title="将jython程序添加到burpsuite中"></a>将jython程序添加到burpsuite中</h3><p>选择添加一个插件：<br><img src="/upload_image/20180504/2.png" alt=""><br>注意下图中的标记部分：<br><img src="/upload_image/20180504/3.png" alt=""><br>说明：类型选择python，文件选择入口文件，burpsuite会自动获取本地的依赖文件；输出这里选择在控制台输出，因为此插件没有写ui界面。</p>
<p>加载成功后，会在控制台输出：<br><img src="/upload_image/20180504/4.png" alt=""></p>
<p>然后我们就去开启浏览器代理，关闭bp拦截，愉快的进行web系统测试吧，若插件检测到了未授权访问的接口，则会输出类似如下：</p>
<p><img src="/upload_image/20180504/6.png" alt=""></p>
<h3 id="增加UI界面代码"><a href="#增加UI界面代码" class="headerlink" title="增加UI界面代码"></a><a href="#增加UI界面代码" title="增加UI界面代码"></a>增加UI界面代码</h3><p>在控制台输出的方式总归没有那么优雅，因此如果能像其内置的功能那样在界面上输出就更好了。以下是一段简单的ui界面开发代码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -<em>- coding:utf-8 -</em>-</span></div><div class="line"></div><div class="line"><span class="comment"># 导入 burp 接口</span></div><div class="line">from burp import IBurpExtender, ITab</div><div class="line"></div><div class="line"><span class="comment"># 导入 Java 库</span></div><div class="line">from javax.swing import JPanel</div><div class="line">from javax.swing import JButton</div><div class="line"></div><div class="line">class BurpExtender(IBurpExtender, ITab):</div><div class="line">    <span class="string">‘’</span><span class="string">‘ 继承burp java父类 ‘</span><span class="string">‘’</span></div><div class="line"></div><div class="line">    def registerExtenderCallbacks(self, callbacks):</div><div class="line">        <span class="comment"># 注册插件信息</span></div><div class="line"></div><div class="line">        self._cb = callbacks <span class="comment"># 回调</span></div><div class="line">        self._hp = callbacks.getHelpers() <span class="comment"># 帮助信息</span></div><div class="line"></div><div class="line">        self._cb.setExtensionName(<span class="string">‘python_test_plugin’</span>) <span class="comment"># 插件名称</span></div><div class="line"></div><div class="line">        <span class="built_in">print</span> <span class="string">‘load python_test_plugin success!’</span></div><div class="line"></div><div class="line">        self.mainPanel = JPanel() <span class="comment"># 面板</span></div><div class="line">        </div><div class="line">        self.testBtn = JButton(u<span class="string">‘一个按钮’</span>, actionPerformed=self.testBtn_onClick) <span class="comment"># 初始化一个 JButton 并绑定单击事件</span></div><div class="line"></div><div class="line">        self.mainPanel.add(self.testBtn) <span class="comment"># 面板中添加这个按钮</span></div><div class="line"></div><div class="line">        self._cb.customizeUiComponent(self.mainPanel) </div><div class="line">        self._cb.addSuiteTab(self)</div><div class="line"></div><div class="line">    def testBtn_onClick(self, event):</div><div class="line">        <span class="comment"># 点击按钮事件</span></div><div class="line"></div><div class="line">        <span class="built_in">print</span> <span class="string">“click button”</span></div><div class="line"></div><div class="line">    def getTabCaption(self):</div><div class="line">        <span class="comment"># 获取tab按钮名称</span></div><div class="line"></div><div class="line">        <span class="built_in">return</span> <span class="string">‘python_test_plugin’</span></div><div class="line"></div><div class="line">    def getUiComponent(self):</div><div class="line">        <span class="comment"># 获取面板内容·</span></div><div class="line"></div><div class="line">        <span class="built_in">return</span> self.mainPanel</div></pre></td></tr></table></figure>

<p>说明：这只是一个ui界面开发的demo，效果如下：</p>
<p><img src="/upload_image/20180504/5.png" alt=""></p>
<h3 id="burp插件开发文档"><a href="#burp插件开发文档" class="headerlink" title="burp插件开发文档"></a><a href="#burp插件开发文档" title="burp插件开发文档"></a>burp插件开发文档</h3><p>这里介绍几个常用的burp类：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">1. 插件入口和帮助接口类：IBurpExtender、IBurpExtenderCallbacks、IExtensionHelpers、IExtensionStateListener</div><div class="line">IBurpExtender接口类是Burp插件的入口，所有Burp的插件均需要实现此接口，并且类命名为BurpExtender。 IBurpExtenderCallbacks接口类是IBurpExtender接口的实现类与Burp其他各个组件（Scanner、Intruder、Spider……）、各个通信对象（HttpRequestResponse、HttpService、SessionHandlingAction）之间的纽带。 IExtensionHelpers、IExtensionStateListener这两个接口类是插件的帮助和管理操作的接口定义。</div><div class="line"></div><div class="line">2. UI相关接口类：IContextMenuFactory、IContextMenuInvocation、ITab、ITextEditor、IMessageEditor、IMenuItemHandler</div><div class="line">这类接口类主要是定义Burp插件的UI显示和动作的处理事件，主要是软件交互中使用。</div><div class="line"></div><div class="line">3. Burp工具组件接口类：IInterceptedProxyMessage、IIntruderAttack、IIntruderPayloadGenerator、IIntruderPayloadGeneratorFactory、IIntruderPayloadProcessor、IProxyListener、IScanIssue、IScannerCheck、IScannerInsertionPoint、IScannerInsertionPointProvider、IScannerListener、IScanQueueItem、IScopeChangeListener</div><div class="line">这些接口类的功能非常好理解，Burp在接口定义的命名中使用了的见名知意的规范，看到接口类的名称，基本就能猜测出来这个接口是适用于哪个工具组件。</div><div class="line"></div><div class="line">4. HTTP消息处理接口类：ICookie、IHttpListener、IHttpRequestResponse、IHttpRequestResponsePersisted、IHttpRequestResponseWithMarkers、IHttpService、IRequestInfo、IParameter、IResponseInfo</div><div class="line"></div><div class="line">这些接口的定义主要是围绕HTTP消息通信过程中涉及的Cookie、Request、Response、Parameter几大消息对象，通过对通信消息头、消息体的数据处理，来达到控制HTTP消息传递的目的。</div></pre></td></tr></table></figure>

<p>关于更多关于burp开发相关的文档，可以参考下：<a href="https://portswigger.net/burp/extender/" target="_blank" rel="noopener">https://portswigger.net/burp/extender/</a></p>
<h3 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a><a href="#本文参考" title="本文参考"></a>本文参考</h3><p><a href="http://xdxd.love/2015/04/20/burpsuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E4%B9%8Bpython%E7%AF%87/" target="_blank" rel="noopener">http://xdxd.love/2015/04/20/burpsuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E4%B9%8Bpython%E7%AF%87/</a></p>
<p>写不动了<del>~</del></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://chucz.club/2018/05/04/burpsuite插件开发之检测越权访问漏洞/" data-id="cjmlsnpqx0036vzrm8ai5ju4f" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/burpsuite/">burpsuite</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/编程之道/">编程之道</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/05/08/利用python开发app实战/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          利用python开发app实战
        
      </div>
    </a>
  
  
    <a href="/2018/04/20/hexo修改默认端口/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">hexo修改默认端口</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ELK/">ELK</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Headless-Chrome/">Headless Chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/K8s/">K8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kafka/">Kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Logrotate/">Logrotate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Puppeteer/">Puppeteer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pyecharts/">Pyecharts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Supervisord/">Supervisord</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SyncWriteStream/">SyncWriteStream</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android-for-python/">android for python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/burpsuite/">burpsuite</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chrome-remote-interface/">chrome_remote_interface</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chromeless/">chromeless</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django/">django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exp/">exp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/falcon/">falcon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/headless-chrome/">headless chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phantomjs爬虫/">phantomjs爬虫</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pychrome/">pychrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python开发app/">python开发app</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web安全/">web安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/whatweb/">whatweb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/x-pack/">x-pack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/余弦相似性/">余弦相似性</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/区块链/">区块链</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/区块链安全/">区块链安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/协程/">协程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/技术研究/">技术研究</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/未授权访问漏洞/">未授权访问漏洞</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/漏洞扫描器/">漏洞扫描器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/爬虫技术/">爬虫技术</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生活杂谈/">生活杂谈</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程之道/">编程之道</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ELK/" style="font-size: 18px;">ELK</a> <a href="/tags/Headless-Chrome/" style="font-size: 10px;">Headless Chrome</a> <a href="/tags/K8s/" style="font-size: 16px;">K8s</a> <a href="/tags/Kafka/" style="font-size: 10px;">Kafka</a> <a href="/tags/Logrotate/" style="font-size: 10px;">Logrotate</a> <a href="/tags/Puppeteer/" style="font-size: 10px;">Puppeteer</a> <a href="/tags/Pyecharts/" style="font-size: 10px;">Pyecharts</a> <a href="/tags/Supervisord/" style="font-size: 10px;">Supervisord</a> <a href="/tags/SyncWriteStream/" style="font-size: 10px;">SyncWriteStream</a> <a href="/tags/android-for-python/" style="font-size: 10px;">android for python</a> <a href="/tags/burpsuite/" style="font-size: 10px;">burpsuite</a> <a href="/tags/chrome-remote-interface/" style="font-size: 10px;">chrome_remote_interface</a> <a href="/tags/chromeless/" style="font-size: 10px;">chromeless</a> <a href="/tags/django/" style="font-size: 10px;">django</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/exp/" style="font-size: 10px;">exp</a> <a href="/tags/falcon/" style="font-size: 10px;">falcon</a> <a href="/tags/headless-chrome/" style="font-size: 10px;">headless chrome</a> <a href="/tags/hexo/" style="font-size: 12px;">hexo</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/phantomjs爬虫/" style="font-size: 10px;">phantomjs爬虫</a> <a href="/tags/pychrome/" style="font-size: 10px;">pychrome</a> <a href="/tags/python/" style="font-size: 14px;">python</a> <a href="/tags/python开发app/" style="font-size: 10px;">python开发app</a> <a href="/tags/web安全/" style="font-size: 10px;">web安全</a> <a href="/tags/whatweb/" style="font-size: 10px;">whatweb</a> <a href="/tags/x-pack/" style="font-size: 10px;">x-pack</a> <a href="/tags/余弦相似性/" style="font-size: 10px;">余弦相似性</a> <a href="/tags/区块链/" style="font-size: 10px;">区块链</a> <a href="/tags/区块链安全/" style="font-size: 10px;">区块链安全</a> <a href="/tags/协程/" style="font-size: 10px;">协程</a> <a href="/tags/技术研究/" style="font-size: 12px;">技术研究</a> <a href="/tags/未授权访问漏洞/" style="font-size: 10px;">未授权访问漏洞</a> <a href="/tags/漏洞扫描器/" style="font-size: 10px;">漏洞扫描器</a> <a href="/tags/爬虫技术/" style="font-size: 12px;">爬虫技术</a> <a href="/tags/生活杂谈/" style="font-size: 10px;">生活杂谈</a> <a href="/tags/编程之道/" style="font-size: 20px;">编程之道</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/09/28/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2018/08/28/记Django开发中的一些常用代码段/">记Django开发中的一些常用代码段</a>
          </li>
        
          <li>
            <a href="/2018/08/21/生成k8s证书的三种方式/">生成k8s证书的三种方式</a>
          </li>
        
          <li>
            <a href="/2018/08/19/23种非常有用的ElasticSearch查询例子/">23种非常有用的ElasticSearch查询例子</a>
          </li>
        
          <li>
            <a href="/2018/08/19/ElasticSearch-索引查询使用指南/">ElasticSearch 索引查询使用指南</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 chucz<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>